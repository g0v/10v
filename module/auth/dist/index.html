<div><div class="ldcv" data-name="authpanel"><div class="base"><div class="inner"><form class="w-100 h-100 d-flex align-items-center justify-content-center"><div class="auth-base d-flex shadow sm rounded border mx-auto"><div class="auth-info mx-auto flex-grow-1 bg-light"><div class="w-100 h-100 position-relative d-flex flex-column p-4"><div class="flex-grow-1 align-items-center d-flex"><div class="ld ld-float-rtl-in" ld="info" data-name="default"><h3 class="mb-3 font-weight-bold" style="line-height:1em">登入服務</h3><p><b>電子郵件</b>即為您的帳號。若您代表您的團隊註冊，建議您使用一個<b>團隊可共用</b>的電子郵件。</p><p>登入之後即可進行各種需要帳號才能使用的操作。</p></div><div class="d-none ld ld-float-rtl-in" ld="info" data-name="signup-failed"><h2 class="mb-4 font-weight-bold">註冊失敗。</h2><p>您可能先前已經註冊過了，或者您所填的資訊有問題。您可以試著：</p><ul><li>切換至登入模式後再試一次</li><li>試著使用更複雜的密碼</li><li>嘗試使用社群帳號登入</li><li><a href="#" onclick="lda.ldcvmgr.toggle('contact');">與我們聯絡</a></li></ul></div><div class="d-none ld ld-float-rtl-in" ld="info" data-name="login-failed"><h2 class="mb-4 font-weight-bold">登入失敗。</h2><p>您之前可能用的是別組帳號或密碼、使用不同的登入方式、甚至尚未註冊過。您可以試著：</p><ul><li>換一組帳號、密碼或登入方式</li><li>確認您的 email 或密碼沒有打錯</li><li>切換至註冊模式後再試一次</li><li><a href="/auth/passwd/reset/" target="_blank" rel="noopener noreferrer">重設密碼</a></li><li><a href="#" onclick="lda.ldcvmgr.toggle('contact');">與我們聯絡</a></li></ul><p>若不斷失敗，亦可嘗試透過 <a href="/auth/">此連結</a> 登入，重設您的使用階段試試。</p></div><div class="d-none ld ld-float-rtl-in" ld="info" data-name="login-exceeded"><h2 class="mb-4 font-weight-bold">登入失敗。</h2><p>您先前已在其它裝置登入，而登入數量已超過我們的限制，因此您無法在此裝置登入。您可以先登出其它的裝置，然後再試一次。</p><p>若您需要其它任何的協助，亦可<a href="#" onclick="lda.ldcvmgr.toggle('contact');">與我們聯絡</a></p></div><div class="d-none ld ld-float-rtl-in" ld="info" data-name="token"><h2 class="mb-4 font-weight-bold">歡迎您！</h2><p>您受邀成為我們的一員。不過，在繼續之前您需要先登入系統。</p></div></div><div class="d-flex justify-content-end"><span>service powered by PlotDB Ltd.</span><img class="ml-1" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCI+CjxwYXRoIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSI3LjQyMTEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTU5LjIsNTEuNmMtMS4zLTctNS4yLTEzLjEtMTEtMTcuMmw5LTE1LjUKYzAuOS0xLjUsMS4xLTMuNCwwLjYtNS4xYy0wLjUtMS43LTEuOC0zLjEtMy40LTMuOWMtNS42LTIuNy0xMS43LTQuMy0xNy45LTQuOEMzNC44LDUsMzMsNS42LDMxLjYsNi44Yy0xLjMsMS4yLTIuMSwyLjktMi4xLDQuN3YyIGMtNS4yLDAuMy0xMC4zLDEuNi0xNS4xLDMuN2gwYy0xLjYsMC43LTIuOSwyLjEtMy40LDMuOGMtMC42LDEuNy0wLjQsMy42LDAuNiw1LjJsNC43LDguMmMtNS44LDQuMS05LjcsMTAuMi0xMSwxNy4yIGMtMC4zLDEuOSwwLjIsMy44LDEuNCw1LjJjMS4yLDEuNSwzLDIuMyw1LDIuM2gyMC41aDBoMjAuNWMxLjksMCwzLjctMC44LDUtMi4zQzU5LDU1LjMsNTkuNSw1My40LDU5LjIsNTEuNnoiLz4gPHBhdGggZmlsbD0iIzdCQzRFMiIgZD0iTTEwLjcsNTIuNWMtMC4xLDAuNCwwLjEsMC43LDAuMiwwLjhjMC4xLDAuMSwwLjQsMC40LDAuOCwwLjRoMTUuOUwxOSwzOUMxNC43LDQyLjMsMTEuNyw0Ny4xLDEwLjcsNTIuNXoiIC8+IDxwYXRoIGZpbGw9IiNGQkIwNUIiIGQ9Ik01Mi44LDUzLjdjMC40LDAsMC43LTAuMiwwLjgtMC40YzAuMS0wLjEsMC4zLTAuNCwwLjItMC44Yy0xLTUuNC00LTEwLjItOC40LTEzLjVsLTguNSwxNC43SDUyLjh6Ii8+IDxwYXRoIGZpbGw9IiNFRDZDQTQiIGQ9Ik0zNSwyOS40YzMsMC4zLDUuOCwxLjEsOC41LDIuM2w5LTE1LjVjMC4yLTAuMywwLjEtMC43LDAuMS0wLjhjLTAuMS0wLjItMC4yLTAuNS0wLjUtMC42IGMtNS0yLjQtMTAuNC0zLjgtMTYtNC4zYzAsMC0wLjEsMC0wLjEsMGMtMC4zLDAtMC42LDAuMi0wLjcsMC4zYy0wLjEsMC4xLTAuMywwLjQtMC4zLDAuOHY0LjZjMCwwLDAsMCwwLDBWMjkuNHoiLz4gPHBhdGggZmlsbD0iI0FDRDM3MiIgZD0iTTI5LjYsMTguOWMtNC41LDAuMy04LjgsMS40LTEyLjksMy4yYy0wLjMsMC4yLTAuNSwwLjQtMC41LDAuNmMtMC4xLDAuMi0wLjEsMC41LDAuMSwwLjhsNC43LDguMiBjMi43LTEuMiw1LjYtMiw4LjUtMi4zVjE4Ljl6Ii8+IDxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik0zNSwzNC44TDM1LDM0LjhjLTAuOS0wLjEtMS44LTAuMi0yLjctMC4yaDBjLTAuOSwwLTEuOCwwLjEtMi43LDAuMmwwLDBjLTIsMC4yLTQsMC43LTUuOCwxLjVsNS44LDEwdjAgbDIuNyw0LjdsMCwwbDAsMGwyLjctNC43djBsNS44LTEwQzM4LjksMzUuNiwzNywzNS4xLDM1LDM0Ljh6Ii8+IDxwYXRoIGQ9Ik01OS4yLDUxLjZjLTEuMy03LTUuMi0xMy4xLTExLTE3LjJsOS0xNS41YzAuOS0xLjUsMS4xLTMuNCwwLjYtNS4xYy0wLjUtMS43LTEuOC0zLjEtMy40LTMuOWMtNS42LTIuNy0xMS43LTQuMy0xNy45LTQuOCBDMzQuOCw1LDMzLDUuNiwzMS42LDYuOGMtMS4zLDEuMi0yLjEsMi45LTIuMSw0Ljd2MmMtNS4yLDAuMy0xMC4zLDEuNi0xNS4xLDMuN2gwYy0xLjYsMC43LTIuOSwyLjEtMy40LDMuOCBjLTAuNiwxLjctMC40LDMuNiwwLjYsNS4ybDQuNyw4LjJjLTUuOCw0LjEtOS43LDEwLjItMTEsMTcuMmMtMC4zLDEuOSwwLjIsMy44LDEuNCw1LjJjMS4yLDEuNSwzLDIuMyw1LDIuM2gyMC41aDBoMjAuNSBjMS45LDAsMy43LTAuOCw1LTIuM0M1OSw1NS4zLDU5LjUsNTMuNCw1OS4yLDUxLjZ6IE01My42LDUzLjNjLTAuMSwwLjEtMC40LDAuNC0wLjgsMC40SDM2LjlMNDUuNSwzOWM0LjQsMy4zLDcuNCw4LjEsOC40LDEzLjUgQzUzLjksNTIuOSw1My43LDUzLjIsNTMuNiw1My4zeiBNMTAuOSw1My4zYy0wLjEtMC4xLTAuMy0wLjQtMC4yLTAuOGMxLTUuNCw0LTEwLjIsOC40LTEzLjVsOC41LDE0LjdIMTEuNyBDMTEuMyw1My43LDExLDUzLjUsMTAuOSw1My4zeiBNMTYuMiwyMi43YzAuMS0wLjIsMC4yLTAuNCwwLjUtMC42YzQuMS0xLjgsOC40LTIuOSwxMi45LTMuMnYxMC42Yy0zLDAuMy01LjgsMS4xLTguNSwyLjNsLTQuNy04LjIgQzE2LjEsMjMuMiwxNi4xLDIyLjgsMTYuMiwyMi43eiBNNTIuNiwxNS4zYzAuMSwwLjIsMC4xLDAuNS0wLjEsMC44bC05LDE1LjVjLTIuNy0xLjItNS42LTItOC41LTIuM1YxNi4xYzAsMCwwLDAsMCwwdi00LjYgYzAtMC40LDAuMi0wLjYsMC4zLTAuOGMwLjEtMC4xLDAuNC0wLjMsMC43LTAuM2MwLDAsMC4xLDAsMC4xLDBjNS42LDAuNSwxMSwxLjksMTYsNC4zQzUyLjQsMTQuOSw1Mi42LDE1LjIsNTIuNiwxNS4zeiBNMzIuMywzNC43IGMwLjksMCwxLjgsMC4xLDIuNywwLjJsMCwwYzIsMC4yLDQsMC43LDUuOCwxLjVsLTUuOCwxMHYwTDMyLjMsNTFsMCwwbDAsMGwtMi43LTQuN3YwbC01LjgtMTBjMS45LTAuOCwzLjgtMS4zLDUuOC0xLjVsMCwwIEMzMC41LDM0LjcsMzEuNCwzNC43LDMyLjMsMzQuN0wzMi4zLDM0Ljd6Ii8+IDwvc3ZnPgo=" style="height:1.3em;vertical-align:-.2em"></div></div></div><div class="auth-form mx-auto flex-grow-1"><div class="d-flex align-items-stretch flex-column justify-content-center h-100 p-4"><div><div class="d-flex mb-4" style="gap:1em"><div class="btn btn-sm btn-primary flex-grow-1" ld="switch" data-name="login" t>Login</div><div class="btn btn-sm btn-text flex-grow-1" ld="switch" data-name="signup" t>Signup</div></div></div><div class="flex-grow-1 d-flex flex-column justify-content-center"><div><div class="form-group"><span t>email</span><input class="form-control" ld="username input" name="username" t t-placeholder="your email address, as account name" autocomplete="username"><div class="invalid-feedback" style="margin-bottom:-.75em" t>invalid email address</div></div><div class="form-group" ld="displayname"><span t>display name</span><input class="form-control" name="displayname" ld="input" t t-placeholder="such as 'Paris Hillton'" autocomplete="displayname"><div class="invalid-feedback" t>required field</div></div><div class="form-group"><span t>password</span><input class="form-control" type="password" ld="password input" name="password" autocomplete="password" t t-placeholder="at least 8 characters"><div class="invalid-feedback" style="margin-bottom:-.75em" t>password too short</div></div></div><div class="text-center text-sm mb-4" t><span>by sign-in, you agree to our</span><span> </span><a class="mx-1" ld="tos" href="/tos" target="_blank" rel="noopener noreferrer">Terms</a><span> </span><span>and</span><span> </span><a class="mx-1" ld="privacy-policy" href="/pp" target="_blank" rel="noopener noreferrer">Privacy Policy</a></div><div class="btn btn-primary d-block my-2 ld-ext-right" ld="submit"><span t ld="submit-text">Login</span><div class="ld ld-spin ld-ring"></div></div><div class="text-right my-2"><a ld="forget-password" href="/auth/passwd/reset"><span t>Forget Password</span>? »</a></div></div><div><div class="sep sep-text mb-4 text-sm text-secondary"><span t>or login with</span></div><div class="d-flex"><div class="btn btn-primary mr-1 flex-grow-1 d-flex justify-content-between align-items-center" ld="social" data-name="fb"><span>Facebook</span> <i class="i-fb"></i></div><div class="btn btn-outline-secondary ml-1 flex-grow-1 d-flex justify-content-between align-items-center" ld="social" data-name="google"><span>Google</span> <i class="i-google"></i></div></div></div></div></div></div></form></div></div></div><style type="text/css">::placeholder{color:#c9cbcf !important;font-weight:200;font-family:sans-serif}[data-name=authpanel] .auth-base{width:700px;height:fit-content}[data-name=authpanel] .auth-info,[data-name=authpanel] .auth-form{width:50%}@media(max-width:768px){.ldcv[data-name=authpanel]>.base{width:100%;height:100%;max-width:100%;max-height:100%;display:block}.ldcv[data-name=authpanel]>.base .inner{border:0;box-shadow:none;border-radius:0}.ldcv[data-name=authpanel] .auth-base{width:100%;height:100%}.ldcv[data-name=authpanel] .auth-info{display:none}.ldcv[data-name=authpanel] .auth-form{width:100%}}.ld.ld-float-rtl-in{animation:ld-float-rtl-in 1s 1 linear;animation-fill-mode:forwards;transform:matrix(1,0,0,1,14.925,0);opacity:.005}@-moz-keyframes ld-float-rtl-in{0%{animation-timing-function:cubic-bezier(0.2242,0.7499,0.3142,0.8148);transform:translate(14.925%,0);opacity:.005}100%{transform:translate(0,0);opacity:1}}@-webkit-keyframes ld-float-rtl-in{0%{animation-timing-function:cubic-bezier(0.2242,0.7499,0.3142,0.8148);transform:translate(14.925%,0);opacity:.005}100%{transform:translate(0,0);opacity:1}}@-o-keyframes ld-float-rtl-in{0%{animation-timing-function:cubic-bezier(0.2242,0.7499,0.3142,0.8148);transform:translate(14.925%,0);opacity:.005}100%{transform:translate(0,0);opacity:1}}@keyframes ld-float-rtl-in{0%{animation-timing-function:cubic-bezier(0.2242,0.7499,0.3142,0.8148);transform:translate(14.925%,0);opacity:.005}100%{transform:translate(0,0);opacity:1}}</style><script type="@plotdb/block">var i18nResource;i18nResource={"zh-TW":{email:"電子郵件","your email address, as account name":"您的電子郵件地址做為帳戶名","invalid email address":"無效的電子郵件","display name":"顯示名稱","such as 'Paris Hillton'":"例如: 王小明","requried field":"不能留白","password too short":"密碼不能太短","password incorrect":"密碼不正確","how shuold we call you":"您希望我們如何稱呼您?",password:"密碼","at least 8 characters":"至少八個字元","by sign-in, you agree to our":"登入即代表您同意我們的",and:"和","or login with":"或使用下列登入",Terms:"使用條款","Privacy Policy":"隱私權政策",Login:"登入",Signup:"註冊","Sign Up":"註冊","Forget Password":"忘記密碼","code we sent you for using this service":"由我們另外發給您的邀請碼","invitation code":"邀請碼","invalid invitation code":"無效的邀請碼","Switch to Password Login":"切換回帳號登入 / 註冊","by Invitation":"使用邀請碼","login successfully":"成功登入"}};module.exports={pkg:{name:"auth",version:"0.0.1",i18n:i18nResource,dependencies:[{name:"ldview",version:"main"},{name:"ldnotify",version:"main"},{name:"ldform",version:"main"},{name:"ldbutton",version:"main",type:"css"},{name:"@loadingio/loading.css",version:"main",path:"lite.min.css"},{name:"ldnotify",version:"main",type:"css",global:true},{name:"curegex",version:"main",path:"curegex.min.js"}]},init:function(n){var e,a,o,u,s,t,i,d,r=this;e=n.ctx,a=n.root,o=n.data,u=n.t;s=e.ldview,t=e.ldnotify,i=e.curegex,d=e.ldform;return function(n){return n.apply(r.mod=r.mod(e))}(function(){var n,e,t,i,r=this;this.ldcv=n={};this._auth=o.auth;e=ld$.find(a,".ldcv[data-name=authpanel]",0);n.authpanel=new ldcover({root:e,baseZ:100});n.authpanel.on("toggle.on",function(){return setTimeout(function(){return t.get("username").focus()},100)});this._tab="login";this._info="default";this.view=t=new s({root:e,action:{keyup:{input:function(n){var e,t;e=n.node,t=n.evt;if(t.keyCode===13){return r.submit()}}},click:{submit:function(n){var e;e=n.node;return r.submit()},switch:function(n){var e;e=n.node;return r.tab(e.getAttribute("data-name"))}}},init:{submit:function(n){var e;e=n.node;return r.ldld=new ldloader({root:e})}},handler:{submit:function(n){var e;e=n.node;return e.classList.toggle("disabled",!r.ready)},"submit-text":function(n){var e;e=n.node;return e.innerText=u(r._tab==="login"?"Login":"Sign Up")},displayname:function(n){var e;e=n.node;return e.classList.toggle("d-none",r._tab==="login")},info:function(n){var e,t;e=n.node;t=e.getAttribute("data-name")!==r._info;if(e.classList.contains("d-none")||t){return e.classList.toggle("d-none",t)}e.classList.toggle("d-none",true);return setTimeout(function(){return e.classList.toggle("d-none",t)},0)},switch:function(n){var e,t;e=n.node;t=e.getAttribute("data-name");e.classList.toggle("btn-text",r._tab!==t);return e.classList.toggle("btn-primary",r._tab===t)}}});this.form=i=new d({names:function(){return["username","password","displayname"]},afterCheck:function(n,e){if(n.username!==1&&!r.isValid.username(e.username.value)){n.username=2}if(n.password!==1){n.password=!e.password.value?1:!r.isValid.password(e.password.value)?2:0}if(r._tab==="login"){return n.displayname=0}else{return n.displayname=!e.displayname.value?1:!!e.displayname.value?0:2}},root:e});return this.form.on("readystatechange",function(n){r.ready=n;return r.view.render("submit")})})},interface:function(){var t=this;return function(n,e){n==null&&(n=true);e==null&&(e={});if(e.tab){t.mod.tab(e.tab)}if(e.lock){t.mod.ldcv.authpanel.lock()}if(n){return t.mod.ldcv.authpanel.get()}else{return t.mod.auth.fetch().then(function(n){return this.mod.ldcv.authpanel.set(n)})}}},mod:function(n){var e,r,t;e=n.ldview,r=n.ldnotify,t=n.curegex;return{tab:function(n){if(/failed/.exec(this._info)){this._info="default"}this._tab=n;return this.view.render()},isValid:{username:function(n){return t.get("email").exec(n)},password:function(n){return n&&n.length>=8}},info:function(n){this._info=n;return this.view.render("info")},submit:function(){var n,e,t,i=this;if(!this.form.ready()){return}n=this.form.values();e=(t={},t.username=n.username,t.password=n.password,t.displayname=n.displayname,t);return this.ldld.on().then(function(){return debounce(1e3)}).then(function(){var n;n={};return ld$.fetch(i._auth.apiRoot()+""+i._tab,{method:"POST"},{json:e})})["catch"](function(n){if(lderror.id(n)!==1005){return Promise.reject(n)}return ld$.fetch(i._auth.apiRoot()+"reset",{method:"POST"}).then(function(){return i._auth.fetch({renew:true})}).then(function(){return ld$.fetch(i._auth.apiRoot()+""+i._tab,{method:"POST"},{json:e})})}).then(function(){return i._auth.fetch()})["finally"](function(){return i.ldld.off()}).then(function(n){i.info("default");i.form.reset();i.ldcv.authpanel.set(n);r.send("success","login successfully");return n})["catch"](function(n){console.log(n);if(lderror.id(n)===1004){return i.info("login-exceeded")}i.info(i._tab+"-failed");i.form.fields.password.value=null;return i.form.check({n:"password",now:true})})}}}};</script></div>
